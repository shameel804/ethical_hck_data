{
    "id": "learn_dynamic_analysis",
    "topicId": "dynamic_analysis",
    "topicTitle": "Dynamic Analysis",
    "description": "Techniques for analyzing malware behavior by running it in a controlled environment (Sandbox, Debugger).",
    "baseKP": 100,
    "slides": [
        {
            "id": "dynamic_intro_1",
            "type": "content",
            "title": "Let it Burn üî•",
            "content": "# Dynamic Analysis\n\nObserving malware **while it runs**.\n\n## Why?\n-   **Deobfuscation**: Malware *must* unpack itself to run.\n-   **Behavior**: See exactly what files it touches, network connections it makes, and keys it logs.\n-   **Confirmation**: Verify theories from static analysis."
        },
        {
            "id": "sandbox_environment",
            "type": "content",
            "title": "The Sandbox Vibe",
            "content": "# Safety First üõë\n\nNever run malware on your host machine.\n\n## Lab Setup\n-   **Virtual Machines (VM)**: VirtualBox, VMware.\n-   **Network Isolation**: Host-only networking or a fake internet (INetSim).\n-   **Snapshots**: Take a snapshot *before* infection so you can revert instantly."
        },
        {
            "id": "procmon_analysis",
            "type": "content",
            "title": "Process Monitor (ProcMon)",
            "content": "# ProcMon üïµÔ∏è\n\nPart of Sysinternals. Records real-time system activity.\n\n## Filters\n-   Filter by **Process Name** (`malware.exe`).\n-   **Operations**:\n    -   `WriteFile` (Dropping payloads).\n    -   `RegSetValue` (Persistence).\n    -   `ProcessCreate` (Launching CMD/Powershell)."
        },
        {
            "id": "network_monitoring",
            "type": "content",
            "title": "Network Monitoring",
            "content": "# WireShark & Fiddler ü¶à\n\n Malware needs to talk home (C2).\n\n-   **Reflected DNS**: Looking for domain lookups (`evil.com`).\n-   **HTTP Requests**: `POST /login.php` (Sending stolen creds).\n-   **Non-Standard Ports**: Traffic on port 4444 (Metasploit default).\n-   **TLS**: Malware often uses encrypted channels. Fiddler can intercept HTTPS if you install its root cert."
        },
        {
            "id": "inetsim_fake_net",
            "type": "content",
            "title": "Faking the Internet",
            "content": "# INetSim üåê\n\nIf you block internet, malware might quit. If you let it connect, you alert the attacker.\n\n**Solution**: Fake services.\n-   **Fake DNS**: Resolves everything to `127.0.0.1`.\n-   **Fake HTTP**: Returns \"200 OK\" to any request.\n-   Allows you to see *what* the malware is asking for without letting it leave your lab."
        },
        {
            "id": "process_hacker",
            "type": "content",
            "title": "Process Hacker / Explorer",
            "content": "# Analyzing Processes ‚öôÔ∏è\n\n-   **Tree View**: Who started whom? (Word.exe -> Powershell.exe = BAD).\n-   **Memory Strings**: Read strings from RAM (often contains unpacked passwords/URLs).\n-   **Handles**: What files/mutexes does it have open?"
        },
        {
            "id": "registry_persistence",
            "type": "content",
            "title": "Registry Changes",
            "content": "# Watching the Registry üìö\n\nMalware wants to survive a reboot.\n\n## Common Keys\n-   `HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run`\n-   `HKLM\\Software\\...\\RunOnce`\n-   `HKLM\\System\\CurrentControlSet\\Services` (Installing a service).\n\nUse **RegShot** to compare registry before and after infection."
        },
        {
            "id": "debugging_dynamic",
            "type": "content",
            "title": "Debugging (x64dbg)",
            "content": "# Stepping Through üêû\n\nPaused execution.\n\n-   **Breakpoints**: Stop just before `VirtualAlloc` (often used during unpacking) or `CreateFile`.\n-   **Register Manipulation**: Change the ZF (Zero Flag) to force a jump (bypass \"IsDebuggerPresent\" check).\n-   **Dumping**: Dump the unpacked code from memory to disk."
        },
        {
            "id": "api_monitoring",
            "type": "content",
            "title": "API Monitoring",
            "content": "# API Monitor üé£\n\nTool to hook Windows APIs and log calls.\n\n-   See arguments passed to functions.\n-   Example: `InternetConnect(Server=\"evil.com\", Port=80)`.\n-   Easier than reading Assembly."
        },
        {
            "id": "automated_sandboxes",
            "type": "content",
            "title": "Automated Sandboxes",
            "content": "# Cuckoo / Any.Run üì¶\n\nUpload a file, get a report 5 minutes later.\n\n-   **Screenshots**: See what happened.\n-   **PCAP**: Download network traffic.\n-   **IOCs**: List of IPs and Hashes.\n-   **Interactive (Any.Run)**: Lets you click buttons inside the VM while recording."
        },
        {
            "id": "dynamic_quiz",
            "type": "quiz",
            "title": "Dynamic Quiz",
            "content": "Lab safety.",
            "quizQuestion": "Why should you use 'Host-Only' networking when analyzing malware?",
            "quizOptions": [
                "To make the internet faster",
                "To prevent malware from infecting other devices on your LAN or attacking external targets",
                "To save bandwidth",
                "To allow the malware to update itself"
            ],
            "correctOptionIndex": 1
        },
        {
            "id": "anti_analysis",
            "type": "content",
            "title": "Anti-Analysis Tricks",
            "content": "# It Knows You're Watching üëÅÔ∏è\n\n-   **Sleep**: \"Sleep for 10 minutes\". (Sandboxes usually timeout after 2 mins).\n-   **Mouse Movement**: \"If mouse doesn't move, I am in a sandbox. Quit.\"\n-   **Core Count**: \"If CPU cores < 2, I am in a VM. Quit.\""
        },
        {
            "id": "memory_forensics",
            "type": "content",
            "title": "Memory Forensics",
            "content": "# Volatility üß†\n\nAnalyzing a RAM dump (`.mem`).\n\n-   **pslist**: List processes (even hidden ones).\n-   **netscan**: List network connections.\n-   **malfind**: specific plugin to find injected code (RWX memory segments)."
        },
        {
            "id": "dynamic_limitations",
            "type": "content",
            "title": "Limitations",
            "content": "# When It Fails üìâ\n\n-   **Logic Bombs**: \"Only run on Jan 1st\". Dynamic analysis today won't see it.\n-   **C2 Down**: If the server is offline, the malware might do nothing.\n-   **Anti-VM**: If it detects the environment, it behaves innocently."
        },
        {
            "id": "dynamic_summary",
            "type": "content",
            "title": "Module Summary",
            "content": "# Wrap Up üéÅ\n\n-   **Isolation**: VM + FakeNet.\n-   **Monitoring**: ProcMon + Wireshark.\n-   **Interaction**: Click, type, engage (to bypass idle checks).\n-   **Debugging**: Manipulate execution flow.\n\nDynamic analysis reveals the ground truth of behavior."
        }
    ]
}