{
    "id": "learn_static_analysis",
    "topicId": "static_analysis",
    "topicTitle": "Static Analysis",
    "description": "Techniques for analyzing malware and binaries without executing them: Hashing, Strings, Headers, and Disassembly.",
    "baseKP": 100,
    "slides": [
        {
            "id": "static_intro_1",
            "type": "content",
            "title": "Safe Dissection ü©∫",
            "content": "# Static Analysis\n\nAnalyzing a file **without running it**.\n\n## Why?\n-   **Safety**: Running malware is dangerous.\n-   **Speed**: Can be automated quickly.\n-   **Scope**: Shows potential capabilities, not just what it does *right now*."
        },
        {
            "id": "file_fingerprinting",
            "type": "content",
            "title": "Fingerprinting (Hashing)",
            "content": "# Identifying the Suspect üÜî\n\nCreating a unique signature for the file.\n\n-   **MD5/SHA256**: Cryptographic hashes. Determine if this EXACT file has been seen before (VirusTotal).\n-   **Imphash**: Hash of the Import Table. Detects variants of the same malware family.\n-   **Fuzzy Hashing (SSDeep)**: Detects similar files (e.g., only 1 byte changed)."
        },
        {
            "id": "antivirus_scanning",
            "type": "content",
            "title": "AV Scanning",
            "content": "# Virustotal ü¶†\n\nThe first step.\n\nUpload the hash (not the file, if confidential) to VirusTotal.\n-   **Results**: \"50/70 engines detected this\".\n-   **Names**: AV vendors give clues (`Trojan.Emotet`, `Ransom.WannaCry`)."
        },
        {
            "id": "strings_1",
            "type": "content",
            "title": "Strings Analysis",
            "content": "# Reading the Tea Leaves üçµ\n\nBinaries contain ASCII and Unicode strings.\n\n## Detects\n-   **IP Addresses/URLs** (C2 servers).\n-   **File Names** (`dropped.exe`).\n-   **Error Messages** (\"Error connecting to keylogger\").\n-   **Libraries** (`openssl`, `ws2_32.dll`).\n\n> üõ†Ô∏è **Tool**: `strings.exe` or `FLOSS` (decodes obfuscated strings)."
        },
        {
            "id": "pe_header_1",
            "type": "content",
            "title": "PE Headers (Imports)",
            "content": "# Import Address Table (IAT) üì•\n\nShows which Windows APIs the malware uses.\n\n-   `InternetOpenUrl`: Connects to internet.\n-   `CreateFile` / `WriteFile`: File manipulation.\n-   `CryptEncrypt`: Ransomware indicator?\n-   `GetAsyncKeyState`: Keylogger indicator?\n\nIf a program imports NOTHING but `LoadLibrary`, it is likely **Packed**."
        },
        {
            "id": "pe_header_exports",
            "type": "content",
            "title": "PE Headers (Exports)",
            "content": "# Exports üì§\n\nMostly for DLLs.\n\nIf a DLL exports a function named `InstallService` or `HookKeyboard`, it gives away its purpose.\n\n> üõ†Ô∏è **Tool**: `PEStudio` or `CFF Explorer`."
        },
        {
            "id": "packing_detection",
            "type": "content",
            "title": "Packed Malware",
            "content": "# Detection: Is it Packed? üì¶\n\n-   **High Entropy**: Packed sections look like random noise (Encryption/Compression). Entropy > 7.0.\n-   **Few Imports**: Only `GetProcAddress` and `LoadLibrary`.\n-   **Non-standard Section Names**: `UPX0`, `UPX1`.\n\n> üõ†Ô∏è **Tool**: `Exeinfo PE` or `Detect It Easy (DiE)`."
        },
        {
            "id": "yara_rules",
            "type": "content",
            "title": "YARA Rules",
            "content": "# Pattern Matching üîç\n\n**YARA** is the standard for malware classification.\n\nIt allows you to write rules based on strings, hex bytes, and logic.\n\n```yara\nrule Is_WannaCry {\n    strings:\n        $s1 = \"msg/m_bulgarian.wnry\"\n        $hex = { 4D 5A 90 00 }\n    condition:\n        $s1 and $hex\n}\n```"
        },
        {
            "id": "resource_analysis",
            "type": "content",
            "title": "Resource Analysis",
            "content": "# Hidden Assets üíé\n\nMalware often hides configuration or secondary payloads in the **Resource Section** (`.rsrc`) of the PE file.\n\n-   Look for: Embedded EXEs, scripts, config binaries.\n-   **Resource Hacker**: Tool to view/extract resources."
        },
        {
            "id": "pdb_paths",
            "type": "content",
            "title": "PDB Paths",
            "content": "# Developer Slip-ups ü§¶\n\n**Program Database (PDB)** paths are sometimes left in the binary.\n\n`C:\\Users\\HackerOne\\Projects\\Ransomwarev2\\Release\\main.pdb`\n\nReveals the attacker's username (`HackerOne`) and project name (`Ransomwarev2`)."
        },
        {
            "id": "static_quiz",
            "type": "quiz",
            "title": "Static Quiz",
            "content": "Check your tools.",
            "quizQuestion": "Which tool detects 'Packed' malware by analyzing entropy and headers?",
            "quizOptions": [
                "Wireshark",
                "Detect It Easy (DiE)",
                "Notepad",
                "Ping"
            ],
            "correctOptionIndex": 1
        },
        {
            "id": "disassembly_1",
            "type": "content",
            "title": "Disassembly",
            "content": "# Reading Assembly üìú\n\nOpening the file in IDA/Ghidra.\n\n-   **Static Code Analysis**: Tracing logic without running.\n-   **Identify Main**: Where does the code start?\n-   **Xrefs (Cross-References)**: Who calls this function? Where is this string used?"
        },
        {
            "id": "cfg_analysis",
            "type": "content",
            "title": "Control Flow Graph",
            "content": "# Visualizing Logic üó∫Ô∏è\n\n-   Look for complex loops (Encryption routines).\n-   Look for XOR operations (Decryption).\n-   Look for large switch statements (Command handlers)."
        },
        {
            "id": "authenticode",
            "type": "content",
            "title": "Digital Signatures",
            "content": "# Authenticode ‚úçÔ∏è\n\n-   **Signed**: Valid certificate from a trusted CA. (Good sign, but keys can be stolen).\n-   **Invalid Signature**: Tampered binary.\n-   **Unsigned**: Common for malware.\n\nStuxnet used stolen Realtek certificates to bypass drivers checks."
        },
        {
            "id": "sast_source",
            "type": "content",
            "title": "Source Code Analysis (SAST)",
            "content": "# If you have Source üìÑ\n\nIf analyzing a script (Python, JS, PowerShell).\n\n-   **Deobfuscation**: Renaming variables, removing junk.\n-   **Pattern Scanning**: `grep` for `base64`, `eval`, `subprocess`.\n-   **Linting**: Static analysis tools for bugs (SonarQube)."
        },
        {
            "id": "limitations_static",
            "type": "content",
            "title": "Limitations",
            "content": "# Hitting the Wall üß±\n\nStatic analysis fails when:\n-   **Packing**: The code is encrypted.\n-   **Obfuscation**: The logic is spaghetti code.\n-   **Dynamic Loading**: APIs are resolved at runtime (hiding imports).\n\nThis is where **Dynamic Analysis** takes over."
        },
        {
            "id": "static_summary",
            "type": "content",
            "title": "Module Summary",
            "content": "# Wrap Up üéÅ\n\n-   **Hash**: Identify it.\n-   **Strings**: Read it.\n-   **Imports**: Guess its capability.\n-   **Packer**: Check if it's hiding.\n-   **YARA**: Classify it.\n\nStatic analysis is the reconnaissance phase!"
        }
    ]
}