{
    "id": "learn_vulnerability_types",
    "topicId": "vulnerability_types",
    "topicTitle": "Vulnerability Types",
    "description": "Understand the weaknesses that attackers exploit, from bad configurations to broken logic.",
    "baseKP": 100,
    "slides": [
        {
            "id": "vt_1",
            "type": "content",
            "title": "Introduction to Vulnerabilities",
            "content": "# Vulnerabilities üêõ\n\nA **vulnerability** is a weakness or flaw in a system, application, or process that can be exploited by a threat.\n\n> \"Vulnerabilities are the gates through which threats enter.\"\n\n## The CVE System\nKnown vulnerabilities are cataloged in the **CVE (Common Vulnerabilities and Exposures)** list.\n- Format: `CVE-YYYY-NNNN`\n- Example: `CVE-2021-44228` (Log4Shell)\n\n## Categories\n1.  **Configuration:** \"It was secure, but you set it up wrong.\"\n2.  **Software:** \"The code is broken.\"\n3.  **Design:** \"The blueprint is flawed.\"\n4.  **Business Logic:** \"It works as designed, but that's the problem.\""
        },
        {
            "id": "vt_2",
            "type": "content",
            "title": "Configuration Vulnerabilities",
            "content": "# Configuration Vulnerabilities ‚öôÔ∏è\n\nThe most common source of breaches. The software is fine, but the settings are not.\n\n## Common Examples\n- **Default Credentials:** Leaving `admin/admin` on a router or database.\n- **Open Ports:** Exposing SSH (22) or RDP (3389) to the entire internet.\n- **Unnecessary Services:** Running a web server on a machine that just needs to be a file server.\n- **Misconfigured S3 Buckets:** Making private AWS storage \"Public\".\n- **Lack of Encryption:** Using HTTP instead of HTTPS.\n\n> üîç **Fix:** Security Hardening (CIS Benchmarks)."
        },
        {
            "id": "vt_3",
            "type": "content",
            "title": "Software Vulnerabilities",
            "content": "# Software Vulnerabilities üíæ\n\nBugs in the code that allow unintended behavior.\n\n## Buffer Overflow\nWriting more data to a buffer than it can hold, overwriting adjacent memory. Can lead to Code Execution.\n\n## Injection Flaws\nTreating untrusted data as code.\n- **SQL Injection:** `SELECT * FROM users WHERE name = '$user'`\n- **Command Injection:** `os.system(\"ping \" + host)`\n\n## Race Conditions\nA flaw where the timing of events affects the outcome (TOCTOU - Time of Check to Time of Use).\n\n```c\n// Buffer Overflow Example (C)\nchar buffer[10];\nstrcpy(buffer, \"This string is way too long for the buffer\"); // CRASH!\n```"
        },
        {
            "id": "vt_4",
            "type": "content",
            "title": "SQL Injection Demo",
            "content": "# Visualizing SQL Injection üíâ\n\nWhen data becomes code.\n\n```sql\n-- Normal Query\nSELECT * FROM users WHERE username = 'admin' AND password = 'password123';\n\n-- Attack Input: admin' --\nSELECT * FROM users WHERE username = 'admin' --' AND password = '...';\n```\n\nThe `--` comments out the password check! The attacker logs in as admin without a password.\n\n<!-- FULL_CODE_START\nimport sqlite3\n\nprint(\"=== SQL Injection Simulation ===\\n\")\n\n# Create in-memory DB\nconn = sqlite3.connect(':memory:')\ncursor = conn.cursor()\ncursor.execute('CREATE TABLE users (id INTEGER PRIMARY KEY, username TEXT, password TEXT)')\ncursor.execute(\"INSERT INTO users (username, password) VALUES ('admin', 'supersecret')\")\ncursor.execute(\"INSERT INTO users (username, password) VALUES ('alice', 'alice123')\")\n\ndef login_vulnerable(username, password):\n    query = f\"SELECT * FROM users WHERE username = '{username}' AND password = '{password}'\"\n    print(f\"Executing Query: {query}\")\n    try:\n        cursor.execute(query)\n        user = cursor.fetchone()\n        if user:\n            print(\"‚úÖ Login Successful! Access Granted.\")\n        else:\n            print(\"‚ùå Login Failed.\")\n    except Exception as e:\n        print(f\"‚ö†Ô∏è SQL Error: {e}\")\n\nprint(\"--- Scenario 1: Normal Login ---\")\nlogin_vulnerable(\"admin\", \"supersecret\")\n\nprint(\"\\n--- Scenario 2: Attack Login (SQL Injection) ---\")\n# The payload: admin' OR '1'='1\n# This makes the query: ... WHERE username = 'admin' OR '1'='1' AND password = '...'\n# Since '1'='1' is TRUE, the whole condition is TRUE.\npayload = \"admin' OR '1'='1\"\nlogin_vulnerable(payload, \"anything\")\n\nprint(\"\\n\" + \"=\"*40)\nprint(\"Never concatenate strings to build SQL queries! Use Parameterized Queries.\")\nFULL_CODE_END -->"
        },
        {
            "id": "vt_5",
            "type": "content",
            "title": "Design Flaws",
            "content": "# Design Flaws üèóÔ∏è\n\nThe code is perfect, but the logic is flawed.\n\n## Examples\n- **Insecure Direct Object References (IDOR):** `app.com/invoice?id=100`. I change 100 to 101 and see someone else's invoice. The system checks \"Is ID valid?\" (Yes) but forgets \"Does user own ID?\" (No).\n- **Missing Encryption:** Designing a password database that stores plaintext passwords.\n- **Trusting Client-Side Data:** Relying on the browser to calculate the price. Attackers can modify the request to `price=0.01`.\n\n> üß± **Fix:** Threat Modeling during design phase."
        },
        {
            "id": "vt_6",
            "type": "content",
            "title": "Business Logic Vulnerabilities",
            "content": "# Business Logic Vulnerabilities üíº\n\nAbusing the legitimate workflow of the application.\n\n## Example: The Coupon Hack\n1.  Site allows 1 coupon code.\n2.  Attacker applies \"WELCOME10\" (-10%).\n3.  Attacker applies \"SUMMER20\" (-20%). Site replaces the first.\n4.  **Logic Flaw:** Attacker calls the API directly and sends `[\"WELCOME10\", \"SUMMER20\"]`. The backend loops through the array and applies both because the developer assumed the UI only sends one.\n\n## Example: Infinite Money\n1.  Transfer $1000 from Savings to Checking.\n2.  Launch 10 threads to do it simultaneously (Race Condition).\n3.  System checks balance (Yes, $1000 exists) 10 times *before* deducting.\n4.  Result: $10,000 in Checking, -$9000 (or $0) in Savings."
        },
        {
            "id": "vt_7",
            "type": "content",
            "title": "Human Vulnerabilities",
            "content": "# Human Vulnerabilities üß†\n\nHumans are the most complex operating system.\n\n## PEBKAC\n\"Problem Exists Between Keyboard And Chair.\"\n\n## Weaknesses\n- **Curiosity:** Clicking links, plugging in USBs.\n- **Trust:** Believing the person on the phone is IT.\n- **Laziness:** Reusing passwords, choosing \"123456\".\n- **Fear:** \"Pay this invoice now or you are fired!\"\n\n> üõ°Ô∏è **Fix:** Security Awareness Training and Phishing Simulations."
        },
        {
            "id": "vt_8",
            "type": "content",
            "title": "CVSS: Scoring Vulnerabilities",
            "content": "# CVSS (Common Vulnerability Scoring System) üíØ\n\nHow do we know which bug is worse?\n\n## Scores (0.0 - 10.0)\n- **Low (0.1 - 3.9)**\n- **Medium (4.0 - 6.9)**\n- **High (7.0 - 8.9)**\n- **Critical (9.0 - 10.0)**\n\n## Metrics vector\n- **Attack Vector (AV):** Network vs Physical.\n- **Attack Complexity (AC):** Low vs High.\n- **Privileges Required (PR):** None vs Admin.\n- **User Interaction (UI):** Required vs None.\n- **Scope (S):** Changed vs Unchanged.\n- **Confidentiality/Integrity/Availability (C/I/A):** Impact.\n\n**Example:** Log4Shell was **10.0** (Network, Low Complexity, No Privs, No UI, High Impact)."
        },
        {
            "id": "vt_9",
            "type": "quiz",
            "title": "Vuln Quiz",
            "content": "Identify the vulnerability category.",
            "quizQuestion": "A developer leaves 'debug=True' enabled in the production web server configuration, revealing stack traces to users. What type of vulnerability is this?",
            "quizOptions": [
                "Software Vulnerability",
                "Configuration Vulnerability",
                "Design Flaw",
                "Business Logic Flaw"
            ],
            "correctOptionIndex": 1
        },
        {
            "id": "vt_10",
            "type": "content",
            "title": "Module Summary",
            "content": "# Module Summary üéì\n\nYou see now that systems break in many ways.\n\n## Recap\n- **Configuration:** Misconfigured settings (Open S3 buckets).\n- **Software:** Buggy code (Buffer overflows, SQLi).\n- **Design:** Flawed architecture (IDOR).\n- **Logic:** Abusing valid workflows (Coupon stacking).\n- **Human:** Social engineering targets.\n\n## What's Next?\nWe've covered the \"Common\" threats. Now we look at the **advanced** ones: **Advanced Persistent Threats (APTs)**."
        }
    ]
}