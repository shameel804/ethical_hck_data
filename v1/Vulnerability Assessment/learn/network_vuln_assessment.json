{
    "id": "learn_network_vuln_assessment",
    "topicId": "network_vuln_assessment",
    "topicTitle": "Network Vulnerability Assessment",
    "description": "Examine the infrastructure itself. From weak protocols to wireless networks.",
    "baseKP": 100,
    "slides": [
        {
            "id": "nva_1",
            "type": "content",
            "title": "Introduction to Network Assessment",
            "content": "# Network Assessment üåê\n\nWhile web apps are flashy, the network infrastructure (routers, switches, servers) is the foundation. If the foundation cracks, the house falls.\n\n## Scope\n- **Internal Network:** What can an insider or compromised laptop see?\n- **External Network:** What is exposed to the internet?\n- **Wireless:** Is the WiFi secure?\n\n> üéØ **Goal:** Ensure the pipes carrying the data are secure."
        },
        {
            "id": "nva_2",
            "type": "content",
            "title": "Service Vulnerabilities",
            "content": "# Service Vulnerabilities üõ†Ô∏è\n\nOutdated software running on open ports.\n\n## Common Suspects\n- **SMB (Port 445):** Famous for EternalBlue (WannaCry). Always patch Windows.\n- **RDP (Port 3389):** BlueKeep vulnerability. Brute force target.\n- **FTP (Port 21):** Often allows \"Anonymous\" login with no password.\n- **Telnet (Port 23):** Sends everything in plaintext.\n\n> üõ°Ô∏è **Fix:** Patch software, disable unused services."
        },
        {
            "id": "nva_3",
            "type": "content",
            "title": "Protocol Weaknesses",
            "content": "# Protocol Weaknesses üìú\n\nSome protocols are fundamentally insecure by design.\n\n## Plaintext Protocols (The \"No-Go\" List)\n- **Telnet:** Use SSH instead.\n- **FTP:** Use SFTP/FTPS instead.\n- **HTTP:** Use HTTPS.\n- **POP3/IMAP:** Use POP3S/IMAPS.\n- **SNMPv1/v2:** Sends community strings (passwords) in cleartext. Use SNMPv3.\n\n## Why?\nAnyone on the same network (MitM) can read the traffic using Wireshark."
        },
        {
            "id": "nva_4",
            "type": "content",
            "title": "Wireshark Demo",
            "content": "# Coding: Packet Sniffing ü¶à\n\nDemonstrating how easy it is to read plaintext traffic.\n\n```python\n# Using Scapy to sniff\nfrom scapy.all import sniff\n\ndef packet_callback(packet):\n    if packet.haslayer('Raw'):\n        print(packet['Raw'].load)\n\nsniff(filter=\"tcp port 23\", prn=packet_callback, count=1)\n```\n\n<!-- FULL_CODE_START\n# Initializing a mock packet capture\nprint(\"=== Packet Analysis Demo ===\\n\")\n\n# This represents a raw TCP payload captured from Telnet (Port 23)\n# Hex dump of \"User: admin Password: secret\" sent over the wire\nraw_payload = b\"\\x55\\x73\\x65\\x72\\x3a\\x20\\x61\\x64\\x6d\\x69\\x6e\\x0d\\x0a\\x50\\x61\\x73\\x73\\x77\\x6f\\x72\\x64\\x3a\\x20\\x73\\x75\\x70\\x65\\x72\\x73\\x65\\x63\\x72\\x65\\x74\"\n\nprint(f\"Captured Packet Payload (Raw Bytes):\\n{raw_payload}\")\n\nprint(\"\\n--- Analysis ---\")\ntry:\n    decoded = raw_payload.decode('utf-8')\n    print(f\"Decoded Text:\\n{decoded}\")\n    \n    if \"Password:\" in decoded:\n        print(\"\\n[!] ALERT: Cleartext password found in traffic!\")\n        password = decoded.split(\"Password: \")[1].strip()\n        print(f\"    Compromised Password: {password}\")\nexcept Exception as e:\n    print(f\"Error decoding: {e}\")\n\nprint(\"\\n\" + \"=\"*40)\nprint(\"If this was SSH, the payload would be encrypted garbage.\")\nFULL_CODE_END -->"
        },
        {
            "id": "nva_5",
            "type": "content",
            "title": "Configuration Audits",
            "content": "# Configuration Audits üìã\n\nChecking device settings against best practices (Hardening).\n\n## CIS Benchmarks\nThe Center for Internet Security (CIS) provides PDFs with hundreds of checks.\n- **Password Policy:** Min length 14, complexity enabled.\n- **Lockout Policy:** Lock account after 5 failed attempts.\n- **Logging:** Ensure logging is enabled and sent to a central server.\n- **Banners:** Display \"Authorized Use Only\" warning.\n\n> üîç **Tool:** CIS-CAT or Nessus (Compliance Scan)."
        },
        {
            "id": "nva_6",
            "type": "content",
            "title": "Wireless Assessments",
            "content": "# Wireless Assessment üì°\n\nWiFi is a radio signal; it goes through walls. Anyone in the parking lot is a threat.\n\n## Audit Items\n- **Encryption:** WEP is dead (Cracked in minutes). WPA2-Personal is okay if password is strong. WPA2-Enterprise (802.1X) is best.\n- **SSID Hiding:** Useless security through obscurity.\n- **Guest Network:** Must be isolated (VLAN) from the Corporate network.\n- **Rogue APs:** Employees bringing their own router? (Open backdoor).\n\n## Tools\n- **Aircrack-ng:** Suite for auditing wireless networks.\n- **Kismet:** Wireless detector/sniffer."
        },
        {
            "id": "nva_7",
            "type": "content",
            "title": "Device Hardening",
            "content": "# Device Hardening üõ°Ô∏è\n\nReducing the attack surface.\n\n1.  **Remove Unnecessary Software:** If it's a Database server, it doesn't need Chrome or Office.\n2.  **Disable Unused Accounts:** Guest, Default Admin.\n3.  **Patch Management:** Is the OS updated?\n4.  **Firewall:** Host-based firewall (iptables/Windows Firewall) should be on, even inside the network.\n\n> üí° **Principle:** \"If you don't need it, delete it.\""
        },
        {
            "id": "nva_8",
            "type": "quiz",
            "title": "Network Assessment Quiz",
            "content": "Verify your network knowledge.",
            "quizQuestion": "Which protocol is considered insecure because it transmits data, including passwords, in plaintext?",
            "quizOptions": [
                "SSH",
                "HTTPS",
                "Telnet",
                "SFTP"
            ],
            "correctOptionIndex": 2
        },
        {
            "id": "nva_9",
            "type": "content",
            "title": "Module Summary",
            "content": "# Module Summary üéì\n\nYou've checked the plumbing.\n\n## Recap\n- **Services:** Close unused ports (SMB, RDP).\n- **Protocols:** Kill Telnet/FTP. Use SSH/SFTP.\n- **Hardening:** Follow CIS Benchmarks.\n- **Wireless:** Isolate Guest WiFi.\n\n## What's Next?\nScanners and audits are defensive. Now let's think offensively. Next module: **Advanced Assessment Techniques** (Red Teaming)."
        }
    ]
}